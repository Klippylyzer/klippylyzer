!function(){function e(e){return e&&e.__esModule?e.default:e}function s(e,s,t,a){Object.defineProperty(e,s,{get:t,set:a,enumerable:!0,configurable:!0})}var t=("undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self?self:"undefined"!=typeof window?window:"undefined"!=typeof global?global:{}).parcelRequire94c2;t.register("2ddJE",(function(a,r){var n;n=a.exports,Object.defineProperty(n,"__esModule",{value:!0,configurable:!0}),s(a.exports,"default",(function(){return g}));var i=t("5Sbbl"),c=t("lBpE3"),l=t("dL2yA"),d=t("6cds3"),o=t("42PEG"),u=t("lqM2R"),h=t("kOpwP"),x=t("aKHyj");t("1cTX3");var b=t("bK5gc"),m=t("3BPdl");function j(e){var s=e.length;return c.jsx("span",{children:s>1e5?"".concat((s/1e5).toFixed(1)," km"):s>100?"".concat((s/1e3).toFixed(1)," m"):s>10?"".concat((s/10).toFixed(1),"cm"):"".concat(s.toFixed(1),"mm")})}function f(e){var s=e.duration;return c.jsx("span",{children:s>172800?"".concat((s/86400).toFixed(1)," days"):s>3600?"".concat((s/3600).toFixed(1)," h"):s>60?"".concat((s/60).toFixed(1)," min"):"".concat(s.toFixed(1),"s")})}function g(){var s=x.default().rpc,t=i.slicedToArray(d.useState([]),2),a=t[0],r=t[1],n=i.slicedToArray(d.useState(null),2),g=n[0],p=n[1];return d.useEffect((function(){s&&(s.call("server.history.totals").then((function(e){var s=e.job_totals;p(s)})),s.call("server.history.list").then((function(e){var s=e.count,t=e.jobs;r(t),console.log(s,t.length)})))}),[s,r,p]),m.useRpcHandler(s,"notify_history_changed",(function(e){var s=i.slicedToArray(e,1)[0],t=s.action,a=s.job;console.log(t,a),r(l.produce((function(e){e.unshift(a)})))})),c.jsxs("section",{children:[c.jsx("h2",{className:e(h)("text-xl"),children:"History"}),c.jsx("article",{className:e(h)("flex","flex-row"),children:g&&c.jsxs(c.Fragment,{children:[c.jsx("div",{className:e(h)("card","bg-base-100","dark:bg-base-300","shadow-xl","mr-1"),children:c.jsxs("div",{className:e(h)("card-body"),children:[c.jsx("h2",{className:e(h)("card-title"),children:"Longest Job"}),c.jsx(f,{duration:g.longest_job})]})}),c.jsx("div",{className:e(h)("card","bg-base-100","dark:bg-base-300","shadow-xl","mr-1"),children:c.jsxs("div",{className:e(h)("card-body"),children:[c.jsx("h2",{className:e(h)("card-title"),children:"Longest Print"}),c.jsx(f,{duration:g.longest_print})]})}),c.jsx("div",{className:e(h)("card","bg-base-100","dark:bg-base-300","shadow-xl","mr-1"),children:c.jsxs("div",{className:e(h)("card-body"),children:[c.jsx("h2",{className:e(h)("card-title"),children:"Filament Used"}),c.jsx(j,{length:g.total_filament_used})]})}),c.jsx("div",{className:e(h)("card","bg-base-100","dark:bg-base-300","shadow-xl","mr-1"),children:c.jsxs("div",{className:e(h)("card-body"),children:[c.jsx("h2",{className:e(h)("card-title"),children:"Total Jobs"}),g.total_jobs]})}),c.jsx("div",{className:e(h)("card","bg-base-100","dark:bg-base-300","shadow-xl","mr-1"),children:c.jsxs("div",{className:e(h)("card-body"),children:[c.jsx("h2",{className:e(h)("card-title"),children:"Print Time"}),c.jsx(f,{duration:g.total_print_time})]})}),c.jsx("div",{className:e(h)("card","bg-base-100","dark:bg-base-300","shadow-xl","mr-1"),children:c.jsxs("div",{className:e(h)("card-body"),children:[c.jsx("h2",{className:e(h)("card-title"),children:"Total Time"}),c.jsx(f,{duration:g.total_time})]})})]})}),c.jsxs("table",{className:e(h)("table","table-compact","text-sm"),children:[c.jsx("thead",{children:c.jsxs("tr",{children:[c.jsx("th",{children:"Filename"}),c.jsx("th",{children:"Start"}),c.jsx("th",{children:"Status"}),c.jsx("th",{children:"Total Time"}),c.jsx("th",{children:"Print Time"}),c.jsx("th",{children:"Filament Used"})]})}),c.jsx("tbody",{className:e(h)("text-sm"),children:a.map((function(s){return c.jsxs("tr",{children:[c.jsx("td",{className:e(h)("line-clamp-1"),children:s.filename}),c.jsx("td",{children:new Date(1e3*s.start_time).toLocaleString()}),c.jsx("td",{title:s.status,children:function(){switch(s.status){case b.JobStatus.Printing:case b.JobStatus.InProgress:return c.jsx(o.BsClock,{size:"1.5rem",className:e(h)("fill-primary","-m-0.5")});case b.JobStatus.Completed:return c.jsx(o.BsCheckCircle,{size:"1.5rem",className:e(h)("fill-success","-m-0.5")});case b.JobStatus.Cancelled:return c.jsx(o.BsXCircle,{size:"1.5rem",className:e(h)("fill-info","-m-0.5")});case b.JobStatus.Error:case b.JobStatus.Server_Exit:case b.JobStatus.Klippy_Shutdown:case b.JobStatus.Klippy_Disconnect:return c.jsx(u.TbAlertTriangle,{size:"1.5rem",className:e(h)("fill-error","-m-0.5")})}}()}),c.jsx("td",{children:c.jsx(f,{duration:s.total_duration})}),c.jsx("td",{children:c.jsx(f,{duration:s.print_duration})}),c.jsx("td",{children:c.jsx(j,{length:s.filament_used})})]},s.job_id)}))})]})]})}})),t.register("1cTX3",(function(e,a){s(e.exports,"JobStatus",(function(){return t("bK5gc").JobStatus})),t("iYBia"),t("bK5gc"),t("jPHUz"),t("bzG2A")})),t.register("iYBia",(function(e,s){})),t.register("bK5gc",(function(e,t){var a;s(e.exports,"JobStatus",(function(){return a})),function(e){e.Completed="completed",e.Cancelled="cancelled",e.Error="error",e.Printing="printing",e.InProgress="in_progress",e.Server_Exit="server_exit",e.Klippy_Shutdown="klippy_shutdown",e.Klippy_Disconnect="klippy_disconnect"}(a||(a={}))})),t.register("jPHUz",(function(e,s){})),t.register("bzG2A",(function(e,s){}))}();
//# sourceMappingURL=History.cb627cca.js.map
