{"mappings":"wdAAA,IAAAA,EAAAC,EAAA,S,wGAYe,SAAAC,IACb,MAbFC,SAaUA,EAAU,IAAKC,GAAaC,EAAAC,YAE9BC,EAAKC,EAAAC,WACJC,EAAQC,GAAaC,EAAAC,cAA6BC,IAClDC,EAAYC,GAAiBJ,EAAAC,cAAiCC,GAErEF,EAAAK,WAAU,KACFd,GAAYC,GAElBG,EAAGW,IAAI,SAAUC,SAAShB,IAAWiB,MAAMC,I,IAK1BC,EAJf,IAAKD,EAAQ,OAEbV,EAAUU,GAEV,MAAME,EAA2D,QAAlDD,EAAAD,EAAOG,MAAMC,MAAK,EA3BvCC,KA2B0CA,KAAWA,IAAStB,WAAS,IAAlDkB,OAAA,EAAAA,EAAoDK,GAC9DJ,GACLhB,EAAGW,IAAI,aAAcK,GAAQH,MAAMQ,IACjCZ,EAAcY,WAGjB,CAACrB,EAAIJ,EAAUC,IAElB,MAAMyB,EAAcjB,EAAAkB,SAAgB,KAClC,IAAKf,EAAY,MAAO,aAIxB,OAFY,IAAIgB,YAAY,SAEjBC,OAAOjB,EAAWkB,YAC5B,CAAClB,IAEJ,OACEf,EAAAkC,KAAC,MAAG,C,UACFlC,EAAAkC,KAAC,KAAE,CAACC,UAAWC,EAAAC,EAAA,CAAG,UAAW,e,UAC3BrC,EAAAkC,KAAC,KAAE,C,UACDlC,EAAAsC,IAAC,KAAE,C,SACDtC,EAAAsC,IAACjC,EAAAkC,QAAO,CAACC,GAAG,qBAAqBL,UAAWC,EAAAC,EAAA,CAAG,gBAAiB,sB,SAAuB,cAIzFrC,EAAAkC,KAAC,KAAE,C,UACA,IACDlC,EAAAsC,IAACjC,EAAAkC,QAAO,CAACC,GAAI,sBAAsBrC,IAAYgC,UAAWC,EAAAC,EAAA,CAAG,gBAAiB,sB,SAC3E3B,aAAA,EAAAA,EAAQgB,UAGb1B,EAAAkC,KAAC,KAAE,C,UACA9B,EAAU,IACVW,GACCf,EAAAsC,IAAC,IAAC,CACAG,SAAU1B,EAAW2B,KAAKC,MAAM5B,EAAW2B,KAAKE,YAAY,KAAO,GACnEC,KAAMC,IAAIC,gBAAgB,IAAIC,KAAK,CAACjC,EAAWkB,YAC/CE,UAAWC,EAAAC,EAAA,CAAG,Q,SAEdrC,EAAAsC,IAACW,EAAAC,WAAU,CAACC,KAAK,SAAShB,UAAWC,EAAAC,EAAA,CAAG,0BAMhDrC,EAAAkC,KAAC,QAAK,CAACC,UAAWC,EAAAC,EAAA,CAAG,cAAe,gBAAiB,sB,UAAuB,iBAC3DtB,EAAa,IAAIqC,KAA2B,IAAtBrC,EAAWsC,UAAiBC,iBAAmB,YAIxFtD,EAAAsC,IAACiB,EAAAC,WAAU,CAACC,SAAS,MAAMC,MAAOC,EAAAlD,Q,SAC/BoB,OApET0B,EAAAC,WAAWI,iBAAiB,MAAOC,EAAApD,Y,gFCVnC,IAEAqD,EAAe1B,EAFfnC,EAAA,a,kCCKA,SAAS8D,EAAIC,GACXA,EAAMC,UAAUC,IAAM,CAMpBC,QAAS,CACPC,QAAO,6BACPC,YAAY,GAEdC,QAAS,CACPF,QAAO,gCACPC,YAAY,EACZE,OAAQ,CACN,eAAgB,CACdH,QAAO,2DACPC,YAAY,EACZG,MAAO,YAETC,YAAW,UAGfC,IAAK,CACHN,QAAO,+EAEPC,YAAY,EACZG,MAAO,aAETG,MAAO,CACLP,QAAO,6DACPC,YAAY,EACZG,MAAO,aACPD,OAAQ,CACN,cAAe,CACbH,QAAO,kBACPC,YAAY,KAIlBI,YAAW,KA3CfG,EAAAC,QAAiBd,EACjBA,EAAIe,YAAc,MAClBf,EAAIgB,QAAU","sources":["src/Routes/Backups/BackupFile.tsx","node_modules/react-syntax-highlighter/dist/esm/languages/prism/ini.js","node_modules/refractor/lang/ini.js"],"sourcesContent":["import { useEffect, useMemo, useState } from \"react\";\r\nimport { BsDownload } from \"react-icons/bs\";\r\nimport { NavLink, useParams } from \"react-router-dom\";\r\nimport { PrismLight } from \"react-syntax-highlighter\";\r\nimport PrismLanguageIni from \"react-syntax-highlighter/dist/esm/languages/prism/ini\";\r\nimport PrismThemeTomorrow from \"react-syntax-highlighter/dist/esm/styles/prism/tomorrow\";\r\nimport cx from \"ts-classnames\";\r\n\r\nimport useDb, { Backup, BackupFile } from \"../../Context/Database\";\r\n\r\nPrismLight.registerLanguage(\"ini\", PrismLanguageIni);\r\n\r\nexport default function BackupFile() {\r\n  const { backupId, \"*\": filePath } = useParams<{ backupId: string; \"*\": string }>();\r\n\r\n  const db = useDb();\r\n  const [backup, setBackup] = useState<undefined | Backup>(undefined);\r\n  const [backupFile, setBackupFile] = useState<undefined | BackupFile>(undefined);\r\n\r\n  useEffect(() => {\r\n    if (!(backupId && filePath)) return;\r\n\r\n    db.get(\"backup\", parseInt(backupId)).then((backup) => {\r\n      if (!backup) return;\r\n\r\n      setBackup(backup as Backup);\r\n\r\n      const fileId = backup.files.find(({ name }) => name === filePath)?.id;\r\n      if (!fileId) return;\r\n      db.get(\"backupFile\", fileId).then((file) => {\r\n        setBackupFile(file as BackupFile);\r\n      });\r\n    });\r\n  }, [db, backupId, filePath]);\r\n\r\n  const textContent = useMemo<string>(() => {\r\n    if (!backupFile) return \"Loading...\";\r\n\r\n    const dec = new TextDecoder(\"utf-8\");\r\n\r\n    return dec.decode(backupFile.contents);\r\n  }, [backupFile]);\r\n\r\n  return (\r\n    <div>\r\n      <h3 className={cx(\"text-lg\", \"breadcrumbs\")}>\r\n        <ul>\r\n          <li>\r\n            <NavLink to=\"/moonraker/backups\" className={cx(\"text-gray-600\", \"dark:text-gray-400\")}>\r\n              Backups\r\n            </NavLink>\r\n          </li>\r\n          <li>\r\n            {\" \"}\r\n            <NavLink to={`/moonraker/backups/${backupId}`} className={cx(\"text-gray-600\", \"dark:text-gray-400\")}>\r\n              {backup?.name}\r\n            </NavLink>\r\n          </li>\r\n          <li>\r\n            {filePath}{\" \"}\r\n            {backupFile && (\r\n              <a\r\n                download={backupFile.path.slice(backupFile.path.lastIndexOf(\"/\") + 1)}\r\n                href={URL.createObjectURL(new Blob([backupFile.contents]))}\r\n                className={cx(\"pl-2\")}\r\n              >\r\n                <BsDownload size=\"1.5rem\" className={cx(\"inline-block\")} />\r\n              </a>\r\n            )}\r\n          </li>\r\n        </ul>\r\n\r\n        <small className={cx(\"float-right\", \"text-gray-600\", \"dark:text-gray-400\")}>\r\n          last modified {backupFile ? new Date(backupFile.modified * 1000).toLocaleString() : \"...\"}\r\n        </small>\r\n      </h3>\r\n\r\n      <PrismLight language=\"log\" style={PrismThemeTomorrow}>\r\n        {textContent}\r\n      </PrismLight>\r\n    </div>\r\n  );\r\n}\r\n","import ini from \"refractor/lang/ini.js\";\n;\nexport default ini;","'use strict'\n\nmodule.exports = ini\nini.displayName = 'ini'\nini.aliases = []\nfunction ini(Prism) {\n  Prism.languages.ini = {\n    /**\n     * The component mimics the behavior of the Win32 API parser.\n     *\n     * @see {@link https://github.com/PrismJS/prism/issues/2775#issuecomment-787477723}\n     */\n    comment: {\n      pattern: /(^[ \\f\\t\\v]*)[#;][^\\n\\r]*/m,\n      lookbehind: true\n    },\n    section: {\n      pattern: /(^[ \\f\\t\\v]*)\\[[^\\n\\r\\]]*\\]?/m,\n      lookbehind: true,\n      inside: {\n        'section-name': {\n          pattern: /(^\\[[ \\f\\t\\v]*)[^ \\f\\t\\v\\]]+(?:[ \\f\\t\\v]+[^ \\f\\t\\v\\]]+)*/,\n          lookbehind: true,\n          alias: 'selector'\n        },\n        punctuation: /\\[|\\]/\n      }\n    },\n    key: {\n      pattern:\n        /(^[ \\f\\t\\v]*)[^ \\f\\n\\r\\t\\v=]+(?:[ \\f\\t\\v]+[^ \\f\\n\\r\\t\\v=]+)*(?=[ \\f\\t\\v]*=)/m,\n      lookbehind: true,\n      alias: 'attr-name'\n    },\n    value: {\n      pattern: /(=[ \\f\\t\\v]*)[^ \\f\\n\\r\\t\\v]+(?:[ \\f\\t\\v]+[^ \\f\\n\\r\\t\\v]+)*/,\n      lookbehind: true,\n      alias: 'attr-value',\n      inside: {\n        'inner-value': {\n          pattern: /^(\"|').+(?=\\1$)/,\n          lookbehind: true\n        }\n      }\n    },\n    punctuation: /=/\n  }\n}\n"],"names":["$bbzbN","parcelRequire","$483ef63e702dc72a$export$2e2bcd8739ae039","backupId","filePath","$2ffQE","useParams","db","$apk6Z","default","backup1","setBackup","$7fPBF","useState","undefined","backupFile","setBackupFile","useEffect","get","parseInt","then","backup","ref","fileId","files","find","name","id","file","textContent","useMemo","TextDecoder","decode","contents","jsxs","className","$parcel$interopDefault","$UBbba","jsx","NavLink","to","download","path","slice","lastIndexOf","href","URL","createObjectURL","Blob","$8bTKe","BsDownload","size","Date","modified","toLocaleString","$hT85A","PrismLight","language","style","$iG9kV","registerLanguage","$ktwjc","$ee7f93edd26de788$export$2e2bcd8739ae039","$197381b2d5f39c0b$var$ini","Prism","languages","ini","comment","pattern","lookbehind","section","inside","alias","punctuation","key","value","module","exports","displayName","aliases"],"version":3,"file":"BackupFile.4f43f381.js.map"}