{"version":3,"file":"BackupFile.bdb8d60c.js","sources":["../../node_modules/refractor/lang/ini.js","../../src/Routes/Backups/BackupFile.tsx"],"sourcesContent":["'use strict'\n\nmodule.exports = ini\nini.displayName = 'ini'\nini.aliases = []\nfunction ini(Prism) {\n  Prism.languages.ini = {\n    /**\n     * The component mimics the behavior of the Win32 API parser.\n     *\n     * @see {@link https://github.com/PrismJS/prism/issues/2775#issuecomment-787477723}\n     */\n    comment: {\n      pattern: /(^[ \\f\\t\\v]*)[#;][^\\n\\r]*/m,\n      lookbehind: true\n    },\n    section: {\n      pattern: /(^[ \\f\\t\\v]*)\\[[^\\n\\r\\]]*\\]?/m,\n      lookbehind: true,\n      inside: {\n        'section-name': {\n          pattern: /(^\\[[ \\f\\t\\v]*)[^ \\f\\t\\v\\]]+(?:[ \\f\\t\\v]+[^ \\f\\t\\v\\]]+)*/,\n          lookbehind: true,\n          alias: 'selector'\n        },\n        punctuation: /\\[|\\]/\n      }\n    },\n    key: {\n      pattern:\n        /(^[ \\f\\t\\v]*)[^ \\f\\n\\r\\t\\v=]+(?:[ \\f\\t\\v]+[^ \\f\\n\\r\\t\\v=]+)*(?=[ \\f\\t\\v]*=)/m,\n      lookbehind: true,\n      alias: 'attr-name'\n    },\n    value: {\n      pattern: /(=[ \\f\\t\\v]*)[^ \\f\\n\\r\\t\\v]+(?:[ \\f\\t\\v]+[^ \\f\\n\\r\\t\\v]+)*/,\n      lookbehind: true,\n      alias: 'attr-value',\n      inside: {\n        'inner-value': {\n          pattern: /^(\"|').+(?=\\1$)/,\n          lookbehind: true\n        }\n      }\n    },\n    punctuation: /=/\n  }\n}\n","import { useEffect, useMemo, useState } from \"react\";\nimport { BsDownload } from \"react-icons/bs\";\nimport { NavLink, useParams } from \"react-router-dom\";\nimport { PrismLight } from \"react-syntax-highlighter\";\nimport PrismLanguageIni from \"react-syntax-highlighter/dist/esm/languages/prism/ini\";\nimport PrismThemeTomorrow from \"react-syntax-highlighter/dist/esm/styles/prism/tomorrow\";\n\nimport useDb, { Backup as BackupType, BackupFile as BackupFileType } from \"../../Context/Database\";\nimport cx from \"../../utils/cx\";\n\nPrismLight.registerLanguage(\"ini\", PrismLanguageIni);\n\nexport default function BackupFile() {\n  const { backupId, \"*\": filePath } = useParams<{ backupId: string; \"*\": string }>();\n\n  const db = useDb();\n  const [backup, setBackup] = useState<undefined | BackupType>(undefined);\n  const [backupFile, setBackupFile] = useState<undefined | BackupFileType>(undefined);\n\n  useEffect(() => {\n    if (!(backupId && filePath)) return;\n\n    db.get(\"backup\", parseInt(backupId)).then((backup) => {\n      if (!backup) return;\n\n      setBackup(backup as BackupType);\n\n      const fileId = backup.files.find(({ name }) => name === filePath)?.id;\n      if (!fileId) return;\n      db.get(\"backupFile\", fileId).then((file) => {\n        setBackupFile(file as BackupFileType);\n      });\n    });\n  }, [db, backupId, filePath]);\n\n  const textContent = useMemo<string>(() => {\n    if (!backupFile) return \"Loading...\";\n\n    const dec = new TextDecoder(\"utf-8\");\n\n    return dec.decode(backupFile.contents);\n  }, [backupFile]);\n\n  return (\n    <div>\n      <h3 className={cx(\"text-lg\", \"breadcrumbs\")}>\n        <ul>\n          <li>\n            <NavLink to=\"/moonraker/backups\" className={cx(\"text-gray-600\", \"dark:text-gray-400\")}>\n              Backups\n            </NavLink>\n          </li>\n          <li>\n            {\" \"}\n            <NavLink to={`/moonraker/backups/${backupId}`} className={cx(\"text-gray-600\", \"dark:text-gray-400\")}>\n              {backup?.name}\n            </NavLink>\n          </li>\n          <li>\n            {filePath}{\" \"}\n            {backupFile && (\n              <a\n                download={backupFile.path.slice(backupFile.path.lastIndexOf(\"/\") + 1)}\n                href={URL.createObjectURL(new Blob([backupFile.contents]))}\n                className={cx(\"pl-2\")}\n              >\n                <BsDownload size=\"1.5rem\" className={cx(\"inline-block\")} />\n              </a>\n            )}\n          </li>\n        </ul>\n\n        <small className={cx(\"float-right\", \"text-gray-600\", \"dark:text-gray-400\")}>\n          last modified {backupFile ? new Date(backupFile.modified * 1000).toLocaleString() : \"...\"}\n        </small>\n      </h3>\n\n      <PrismLight language=\"log\" style={PrismThemeTomorrow}>\n        {textContent}\n      </PrismLight>\n    </div>\n  );\n}\n"],"names":["PrismLight","registerLanguage","PrismLanguageIni","backupId","filePath","useParams","db","useDb","backup","setBackup","useState","undefined","backupFile","setBackupFile","useEffect","get","parseInt","then","fileId","files","find","name","id","file","textContent","useMemo","dec","TextDecoder","decode","contents","_jsxs","cx","_jsx","path","slice","lastIndexOf","URL","createObjectURL","Blob","Date","modified","toLocaleString","PrismThemeTomorrow"],"mappings":"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"}